When calculating the average rate for a role, do not compute a single global average. Instead, group the rates by both region and currency, and calculate the average for each group separately. This ensures accurate comparisons and reflects regional cost differences and exchange rates. Use only valid, non-zero values, and include the region and currency in the result for each average.
